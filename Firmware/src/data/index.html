<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
		<title>ESP32 NTP Server with GPS</title>
        <link rel="stylesheet" href="css/basic.css"/>
 
	</head>
	<body onload="pageLoad()">
		<a href="javascript:openMenu()" class="menuOpenBtn">&#9776;</a>
		<div id="menu" class="menu">
			<a href="javascript:closeMenu()" class="menuCloseBtn">x</a>
			<h1 class="menuLbl">Menu</h1>
            <a class="menuBtn" id="MainPageBtn" href="javascript:showMainPage()">Main page</a>
            <a class="menuBtn" id="NotesBtn" href="javascript:showNotes()">Notes</a>
            <a class="menuBtn" id="TimeSettingsBtn" href="javascript:showTimeSettings()">Time settings</a>
            <a class="menuBtn" id="TimeSettingsBtn" href="javascript:showIPv4Settings()">IPv4 settings</a>
            <a class="menuBtn" id="WiFiSettingsBtn" href="javascript:showWiFiSettings()">WiFi settings</a>
			<a class="menuBtn" id="restartBtn" href="javascript:restart()">Restart</a>
		</div>
		
		<div class="content">
            <div id="MainPage" class="views grid">
        
                <H1><label style="/*! margin-left:50%; */display: block;text-align: center;">Elektor NTP Server</label></H1><br>
                 <table>
						<thead>
							<tr>
								<th colspan="2">Display settings</th>
							</tr>
						</thead>
                        
						<tbody>
							<tr>
                            <td>
                             <fieldset>
                               <legend>Swap Displays</legend>
                                As we use two displays the content can be swapped
                                <input type="checkbox" id="SWAP_DISP" name="SWAP_DISP" value="SWAP_DISP">Swap Displays<br>    
                                <button type="button" onclick="SubmitDisplaysettings(); return false;">Submit</button>
                             </fieldset>                             
                            </td>
                            </tr>
                        </tbody>
                            
                </table>
                
                 
                      
                
            </div>
            
             <div id="IPv4Settings" class="views grid">
        
                <H1><label style="/*! margin-left:50%; */display: block;text-align: center;">Elektor NTP Server</label></H1><br>
                 <table>
						<thead>
							<tr>
								<th colspan="2">IPv4 Settings</th>
							</tr>
						</thead>
                      
						<tbody>
                        
							<tr>
                            <td></td><td>
                             
                                <input type="checkbox" id="STATIC_IP" name="STATIC_IP" value="false">Use static IPv4<br> 
                            </td></tr>
                            
                               <tr>
                                <td>
                                IP</td><td> 
                                <input type="number" min="0" max="255" id="IP_0" name="IP_0" value="192">.
                                <input type="number" min="0" max="255" id="IP_1" name="IP_1" value="168">.
                                <input type="number" min="0" max="255" id="IP_2" name="IP_2" value="0">.
                                <input type="number" min="0" max="255" id="IP_3" name="IP_3" value="1"><br> 
                                </td></tr>
                                <tr>
                                <td>Subnet</td><td>
                                <input type="number" min="0" max="255" id="SUB_0" name="SUB_0" value="255">.
                                <input type="number" min="0" max="255" id="SUB_1" name="SUB_1" value="255">.
                                <input type="number" min="0" max="255" id="SUB_2" name="SUB_2" value="255">.
                                <input type="number" min="0" max="255" id="SUB_3" name="SUB_3" value="0"><br> 
                                </td>
                                </tr>
                                <tr>
                                <td>Gateway</td><td>
                                <input type="number" min="0" max="255" id="GW_0" name="GW_0" value="192">.
                                <input type="number" min="0" max="255" id="GW_1" name="GW_1" value="168">.
                                <input type="number" min="0" max="255" id="GW_2" name="GW_2" value="0">.
                                <input type="number" min="0" max="255" id="GW_3" name="GW_3" value="1"><br> 
                                </td></tr>
                                
                                <tr><td>
                                DNS 0</td><td> 
                                <input type="number" min="0" max="255" id="DNS0_0" name="DNS0_0" value="0">.
                                <input type="number" min="0" max="255" id="DNS0_1" name="DNS0_1" value="0">.
                                <input type="number" min="0" max="255" id="DNS0_2" name="DNS0_2" value="0">.
                                <input type="number" min="0" max="255" id="DNS0_3" name="DNS0_3" value="0"><br> 
                                </td></tr>
                                <td>DNS 1</td><td>
                                <input type="number" min="0" max="255" id="DNS1_0" name="DNS1_0" value="0">.
                                <input type="number" min="0" max="255" id="DNS1_1" name="DNS1_1" value="0">.
                                <input type="number" min="0" max="255" id="DNS1_2" name="DNS1_2" value="0">.
                                <input type="number" min="0" max="255" id="DNS1_3" name="DNS1_3" value="0"><br> 
                                </td></tr>
                                 <tr><td></td><td>
                                    <button type="button" onclick="SubmitIPv4Settings(); return false;">Submit</button>
                                     </td></tr>
                              
                             
                             
                        </tbody>
                         
                            
                </table>
                
                 
                      
                
            </div>
                        
                        
			<div id="TimeSettings" class="views grid">
                    <table>
						<thead>
							<tr>
								<th colspan="2">Time settings</th>
							</tr>
						</thead>
                        
						<tbody>
							<tr>
                            <td>
            
            
                        <div id="inputfields">

                        <form action="settime.dat"  method="post">
                         <fieldset>
                         <legend>Local Time</legend>


                            <label for="time">Current Local Time</label>
                            <input type="time" id="time" name="time" value="00:01:01" step=1>

                            <label for="date">Current Date</label>
                            <input type="date" id="date" name="date" value="1970-01-01">
                         
                            <button type="button" onclick="SubmitDateTime(); return false;">Submit</button>
                         </fieldset>
                         
                        </form>

                        <form>
                         <fieldset>
                          <legend>GPS Settings</legend>
                            <input type="checkbox" id="GPS_SYNC_ON" name="GPS_SYNC_ON" value="0" >Sync to GPS <br>
                            <input style="width:60px" type="number" id="GPS_ROLLLOVERCNT" name="gps_rollover_count" min="0" max="10" value="0"> GPS Weekrollover Count</br>
                         <!--   <input style="width:60px" type="number" id="GPS_BAUDRATE" name="gps_baudrate" min="0" max="115200" value="0"> GPS Weekrollover Count</br> -->
                            

                         
                         <button type="button" onclick="SubmitGPSsync(); return false;">Submit</button>
                         </fieldset>
                         </form>

                        <form action="timezone.dat"  method="post">
                         <fieldset>
                          <legend>Timezone</legend>
                        <select name="timezoneid" id="timezoneid" >
                        <option value="0">Africa/Abidjan</option>
                        <option value="1">Africa/Accra</option>
                        <option value="2">Africa/Addis_Ababa</option>
                        <option value="3">Africa/Algiers</option>
                        <option value="4">Africa/Asmera</option>
                        <option value="5">Africa/Bamako</option>
                        <option value="6">Africa/Bangui</option>
                        <option value="7">Africa/Banjul</option>
                        <option value="8">Africa/Bissau</option>
                        <option value="9">Africa/Blantyre</option>
                        <option value="10">Africa/Brazzaville</option>
                        <option value="11">Africa/Bujumbura</option>
                        <option value="12">Africa/Cairo</option>
                        <option value="13">Africa/Casablanca</option>
                        <option value="14">Africa/Ceuta</option>
                        <option value="15">Africa/Conakry</option>
                        <option value="16">Africa/Dakar</option>
                        <option value="17">Africa/Dar_es_Salaam</option>
                        <option value="18">Africa/Djibouti</option>
                        <option value="19">Africa/Douala</option>
                        <option value="20">Africa/El_Aaiun</option>
                        <option value="21">Africa/Freetown</option>
                        <option value="22">Africa/Gaborone</option>
                        <option value="23">Africa/Harare</option>
                        <option value="24">Africa/Johannesburg</option>
                        <option value="25">Africa/Kampala</option>
                        <option value="26">Africa/Khartoum</option>
                        <option value="27">Africa/Kigali</option>
                        <option value="28">Africa/Kinshasa</option>
                        <option value="29">Africa/Lagos</option>
                        <option value="30">Africa/Libreville</option>
                        <option value="31">Africa/Lome</option>
                        <option value="32">Africa/Luanda</option>
                        <option value="33">Africa/Lubumbashi</option>
                        <option value="34">Africa/Lusaka</option>
                        <option value="35">Africa/Malabo</option>
                        <option value="36">Africa/Maputo</option>
                        <option value="37">Africa/Maseru</option>
                        <option value="38">Africa/Mbabane</option>
                        <option value="39">Africa/Mogadishu</option>
                        <option value="40">Africa/Monrovia</option>
                        <option value="41">Africa/Nairobi</option>
                        <option value="42">Africa/Ndjamena</option>
                        <option value="43">Africa/Niamey</option>
                        <option value="44">Africa/Nouakchott</option>
                        <option value="45">Africa/Ouagadougou</option>
                        <option value="46">Africa/Porto-Novo</option>
                        <option value="47">Africa/Sao_Tome</option>
                        <option value="48">Africa/Timbuktu</option>
                        <option value="49">Africa/Tripoli</option>
                        <option value="50">Africa/Tunis</option>
                        <option value="51">Africa/Windhoek</option>
                        <option value="52">America/Adak</option>
                        <option value="53">America/Anchorage</option>
                        <option value="54">America/Anguilla</option>
                        <option value="55">America/Antigua</option>
                        <option value="56">America/Araguaina</option>
                        <option value="57">America/Aruba</option>
                        <option value="58">America/Asuncion</option>
                        <option value="59">America/Barbados</option>
                        <option value="60">America/Belem</option>
                        <option value="61">America/Belize</option>
                        <option value="62">America/Boa_Vista</option>
                        <option value="63">America/Bogota</option>
                        <option value="64">America/Boise</option>
                        <option value="65">America/Buenos_Aires</option>
                        <option value="66">America/Cambridge_Bay</option>
                        <option value="67">America/Cancun</option>
                        <option value="68">America/Caracas</option>
                        <option value="69">America/Catamarca</option>
                        <option value="70">America/Cayenne</option>
                        <option value="71">America/Cayman</option>
                        <option value="72">America/Chicago</option>
                        <option value="73">America/Chihuahua</option>
                        <option value="74">America/Cordoba</option>
                        <option value="75">America/Costa_Rica</option>
                        <option value="76">America/Cuiaba</option>
                        <option value="77">America/Curacao</option>
                        <option value="78">America/Danmarkshavn</option>
                        <option value="79">America/Dawson</option>
                        <option value="80">America/Dawson_Creek</option>
                        <option value="81">America/Denver</option>
                        <option value="82">America/Detroit</option>
                        <option value="83">America/Dominica</option>
                        <option value="84">America/Edmonton</option>
                        <option value="85">America/Eirunepe</option>
                        <option value="86">America/El_Salvador</option>
                        <option value="87">America/Fortaleza</option>
                        <option value="88">America/Glace_Bay</option>
                        <option value="89">America/Godthab</option>
                        <option value="90">America/Goose_Bay</option>
                        <option value="91">America/Grand_Turk</option>
                        <option value="92">America/Grenada</option>
                        <option value="93">America/Guadeloupe</option>
                        <option value="94">America/Guatemala</option>
                        <option value="95">America/Guayaquil</option>
                        <option value="96">America/Guyana</option>
                        <option value="97">America/Halifax</option>
                        <option value="98">America/Havana</option>
                        <option value="99">America/Hermosillo</option>
                        <option value="100">America/Indiana/Indianapolis</option>
                        <option value="101">America/Indiana/Knox</option>
                        <option value="102">America/Indiana/Marengo</option>
                        <option value="103">America/Indiana/Vevay</option>
                        <option value="104">America/Indianapolis</option>
                        <option value="105">America/Inuvik</option>
                        <option value="106">America/Iqaluit</option>
                        <option value="107">America/Jamaica</option>
                        <option value="108">America/Jujuy</option>
                        <option value="109">America/Juneau</option>
                        <option value="110">America/Kentucky/Louisville</option>
                        <option value="111">America/Kentucky/Monticello</option>
                        <option value="112">America/La_Paz</option>
                        <option value="113">America/Lima</option>
                        <option value="114">America/Los_Angeles</option>
                        <option value="115">America/Louisville</option>
                        <option value="116">America/Maceio</option>
                        <option value="117">America/Managua</option>
                        <option value="118">America/Manaus</option>
                        <option value="119">America/Martinique</option>
                        <option value="120">America/Mazatlan</option>
                        <option value="121">America/Mendoza</option>
                        <option value="122">America/Menominee</option>
                        <option value="123">America/Merida</option>
                        <option value="124">America/Mexico_City</option>
                        <option value="125">America/Miquelon</option>
                        <option value="126">America/Monterrey</option>
                        <option value="127">America/Montevideo</option>
                        <option value="128">America/Montreal</option>
                        <option value="129">America/Montserrat</option>
                        <option value="130">America/Nassau</option>
                        <option value="131">America/New_York</option>
                        <option value="132">America/Nipigon</option>
                        <option value="133">America/Nome</option>
                        <option value="134">America/Noronha</option>
                        <option value="135">America/North_Dakota/Center</option>
                        <option value="136">America/Panama</option>
                        <option value="137">America/Pangnirtung</option>
                        <option value="138">America/Paramaribo</option>
                        <option value="139">America/Phoenix</option>
                        <option value="140">America/Port-au-Prince</option>
                        <option value="141">America/Port_of_Spain</option>
                        <option value="142">America/Porto_Velho</option>
                        <option value="143">America/Puerto_Rico</option>
                        <option value="144">America/Rainy_River</option>
                        <option value="145">America/Rankin_Inlet</option>
                        <option value="146">America/Recife</option>
                        <option value="147">America/Regina</option>
                        <option value="148">America/Rio_Branco</option>
                        <option value="149">America/Rosario</option>
                        <option value="150">America/Santiago</option>
                        <option value="151">America/Santo_Domingo</option>
                        <option value="152">America/Sao_Paulo</option>
                        <option value="153">America/Scoresbysund</option>
                        <option value="154">America/Shiprock</option>
                        <option value="155">America/St_Johns</option>
                        <option value="156">America/St_Kitts</option>
                        <option value="157">America/St_Lucia</option>
                        <option value="158">America/St_Thomas</option>
                        <option value="159">America/St_Vincent</option>
                        <option value="160">America/Swift_Current</option>
                        <option value="161">America/Tegucigalpa</option>
                        <option value="162">America/Thule</option>
                        <option value="163">America/Thunder_Bay</option>
                        <option value="164">America/Tijuana</option>
                        <option value="165">America/Tortola</option>
                        <option value="166">America/Vancouver</option>
                        <option value="167">America/Whitehorse</option>
                        <option value="168">America/Winnipeg</option>
                        <option value="169">America/Yakutat</option>
                        <option value="170">America/Yellowknife</option>
                        <option value="171">Antarctica/Casey</option>
                        <option value="172">Antarctica/Davis</option>
                        <option value="173">Antarctica/DumontDUrville</option>
                        <option value="174">Antarctica/Mawson</option>
                        <option value="175">Antarctica/McMurdo</option>
                        <option value="176">Antarctica/Palmer</option>
                        <option value="177">Antarctica/South_Pole</option>
                        <option value="178">Antarctica/Syowa</option>
                        <option value="179">Antarctica/Vostok</option>
                        <option value="180">Arctic/Longyearbyen</option>
                        <option value="181">Asia/Aden</option>
                        <option value="182">Asia/Almaty</option>
                        <option value="183">Asia/Amman</option>
                        <option value="184">Asia/Anadyr</option>
                        <option value="185">Asia/Aqtau</option>
                        <option value="186">Asia/Aqtobe</option>
                        <option value="187">Asia/Ashgabat</option>
                        <option value="188">Asia/Baghdad</option>
                        <option value="189">Asia/Bahrain</option>
                        <option value="190">Asia/Baku</option>
                        <option value="191">Asia/Bangkok</option>
                        <option value="192">Asia/Beirut</option>
                        <option value="193">Asia/Bishkek</option>
                        <option value="194">Asia/Brunei</option>
                        <option value="195">Asia/Calcutta</option>
                        <option value="196">Asia/Choibalsan</option>
                        <option value="197">Asia/Chongqing</option>
                        <option value="198">Asia/Colombo</option>
                        <option value="199">Asia/Damascus</option>
                        <option value="200">Asia/Dhaka</option>
                        <option value="201">Asia/Dili</option>
                        <option value="202">Asia/Dubai</option>
                        <option value="203">Asia/Dushanbe</option>
                        <option value="204">Asia/Gaza</option>
                        <option value="205">Asia/Harbin</option>
                        <option value="206">Asia/Hong_Kong</option>
                        <option value="207">Asia/Hovd</option>
                        <option value="208">Asia/Irkutsk</option>
                        <option value="209">Asia/Istanbul</option>
                        <option value="210">Asia/Jakarta</option>
                        <option value="211">Asia/Jayapura</option>
                        <option value="212">Asia/Jerusalem</option>
                        <option value="213">Asia/Kabul</option>
                        <option value="214">Asia/Kamchatka</option>
                        <option value="215">Asia/Karachi</option>
                        <option value="216">Asia/Kashgar</option>
                        <option value="217">Asia/Katmandu</option>
                        <option value="218">Asia/Krasnoyarsk</option>
                        <option value="219">Asia/Kuala_Lumpur</option>
                        <option value="220">Asia/Kuching</option>
                        <option value="221">Asia/Kuwait</option>
                        <option value="222">Asia/Macao</option>
                        <option value="223">Asia/Macau</option>
                        <option value="224">Asia/Magadan</option>
                        <option value="225">Asia/Makassar</option>
                        <option value="226">Asia/Manila</option>
                        <option value="227">Asia/Muscat</option>
                        <option value="228">Asia/Nicosia</option>
                        <option value="229">Asia/Novosibirsk</option>
                        <option value="230">Asia/Omsk</option>
                        <option value="231">Asia/Oral</option>
                        <option value="232">Asia/Phnom_Penh</option>
                        <option value="233">Asia/Pontianak</option>
                        <option value="234">Asia/Pyongyang</option>
                        <option value="235">Asia/Qyzylorda</option>
                        <option value="236">Asia/Qatar</option>
                        <option value="237">Asia/Rangoon</option>
                        <option value="238">Asia/Riyadh</option>
                        <option value="239">Asia/Saigon</option>
                        <option value="240">Asia/Sakhalin</option>
                        <option value="241">Asia/Samarkand</option>
                        <option value="242">Asia/Seoul</option>
                        <option value="243">Asia/Shanghai</option>
                        <option value="244">Asia/Singapore</option>
                        <option value="245">Asia/Taipei</option>
                        <option value="246">Asia/Tashkent</option>
                        <option value="247">Asia/Tbilisi</option>
                        <option value="248">Asia/Tehran</option>
                        <option value="249">Asia/Thimphu</option>
                        <option value="250">Asia/Tokyo</option>
                        <option value="251">Asia/Ujung_Pandang</option>
                        <option value="252">Asia/Ulaanbaatar</option>
                        <option value="253">Asia/Urumqi</option>
                        <option value="254">Asia/Vientiane</option>
                        <option value="255">Asia/Vladivostok</option>
                        <option value="256">Asia/Yakutsk</option>
                        <option value="257">Asia/Yekaterinburg</option>
                        <option value="258">Asia/Yerevan</option>
                        <option value="259">Atlantic/Azores</option>
                        <option value="260">Atlantic/Bermuda</option>
                        <option value="261">Atlantic/Canary</option>
                        <option value="262">Atlantic/Cape_Verde</option>
                        <option value="263">Atlantic/Faeroe</option>
                        <option value="264">Atlantic/Jan_Mayen</option>
                        <option value="265">Atlantic/Madeira</option>
                        <option value="266">Atlantic/Reykjavik</option>
                        <option value="267">Atlantic/South_Georgia</option>
                        <option value="268">Atlantic/St_Helena</option>
                        <option value="269">Atlantic/Stanley</option>
                        <option value="270">Australia/Adelaide</option>
                        <option value="271">Australia/Brisbane</option>
                        <option value="272">Australia/Broken_Hill</option>
                        <option value="273">Australia/Darwin</option>
                        <option value="274">Australia/Hobart</option>
                        <option value="275">Australia/Lindeman</option>
                        <option value="276">Australia/Lord_Howe</option>
                        <option value="277">Australia/Melbourne</option>
                        <option value="278">Australia/Perth</option>
                        <option value="279">Australia/Sydney</option>
                        <option value="280">Europe/Amsterdam</option>
                        <option value="281">Europe/Andorra</option>
                        <option value="282">Europe/Athens</option>
                        <option value="283">Europe/Belfast</option>
                        <option value="284">Europe/Belgrade</option>
                        <option value="285">Europe/Berlin</option>
                        <option value="286">Europe/Bratislava</option>
                        <option value="287">Europe/Brussels</option>
                        <option value="288">Europe/Bucharest</option>
                        <option value="289">Europe/Budapest</option>
                        <option value="290">Europe/Chisinau</option>
                        <option value="291">Europe/Copenhagen</option>
                        <option value="292">Europe/Dublin</option>
                        <option value="293">Europe/Gibraltar</option>
                        <option value="294">Europe/Helsinki</option>
                        <option value="295">Europe/Istanbul</option>
                        <option value="296">Europe/Kaliningrad</option>
                        <option value="297">Europe/Kiev</option>
                        <option value="298">Europe/Lisbon</option>
                        <option value="299">Europe/Ljubljana</option>
                        <option value="300">Europe/London</option>
                        <option value="301">Europe/Luxembourg</option>
                        <option value="302">Europe/Madrid</option>
                        <option value="303">Europe/Malta</option>
                        <option value="304">Europe/Minsk</option>
                        <option value="305">Europe/Monaco</option>
                        <option value="306">Europe/Moscow</option>
                        <option value="307">Europe/Nicosia</option>
                        <option value="308">Europe/Oslo</option>
                        <option value="309">Europe/Paris</option>
                        <option value="310">Europe/Prague</option>
                        <option value="311">Europe/Riga</option>
                        <option value="312">Europe/Rome</option>
                        <option value="313">Europe/Samara</option>
                        <option value="314">Europe/San_Marino</option>
                        <option value="315">Europe/Sarajevo</option>
                        <option value="316">Europe/Simferopol</option>
                        <option value="317">Europe/Skopje</option>
                        <option value="318">Europe/Sofia</option>
                        <option value="319">Europe/Stockholm</option>
                        <option value="320">Europe/Tallinn</option>
                        <option value="321">Europe/Tirane</option>
                        <option value="322">Europe/Uzhgorod</option>
                        <option value="323">Europe/Vaduz</option>
                        <option value="324">Europe/Vatican</option>
                        <option value="325">Europe/Vienna</option>
                        <option value="326">Europe/Vilnius</option>
                        <option value="327">Europe/Warsaw</option>
                        <option value="328">Europe/Zagreb</option>
                        <option value="329">Europe/Zaporozhye</option>
                        <option value="330">Europe/Zurich</option>
                        <option value="331">Indian/Antananarivo</option>
                        <option value="332">Indian/Chagos</option>
                        <option value="333">Indian/Christmas</option>
                        <option value="334">Indian/Cocos</option>
                        <option value="335">Indian/Comoro</option>
                        <option value="336">Indian/Kerguelen</option>
                        <option value="337">Indian/Mahe</option>
                        <option value="338">Indian/Maldives</option>
                        <option value="339">Indian/Mauritius</option>
                        <option value="340">Indian/Mayotte</option>
                        <option value="341">Indian/Reunion</option>
                        <option value="342">Pacific/Apia</option>
                        <option value="343">Pacific/Auckland</option>
                        <option value="344">Pacific/Chatham</option>
                        <option value="345">Pacific/Easter</option>
                        <option value="346">Pacific/Efate</option>
                        <option value="347">Pacific/Enderbury</option>
                        <option value="348">Pacific/Fakaofo</option>
                        <option value="349">Pacific/Fiji</option>
                        <option value="350">Pacific/Funafuti</option>
                        <option value="351">Pacific/Galapagos</option>
                        <option value="352">Pacific/Gambier</option>
                        <option value="353">Pacific/Guadalcanal</option>
                        <option value="354">Pacific/Guam</option>
                        <option value="355">Pacific/Honolulu</option>
                        <option value="356">Pacific/Johnston</option>
                        <option value="357">Pacific/Kiritimati</option>
                        <option value="358">Pacific/Kosrae</option>
                        <option value="359">Pacific/Kwajalein</option>
                        <option value="360">Pacific/Majuro</option>
                        <option value="361">Pacific/Marquesas</option>
                        <option value="362">Pacific/Midway</option>
                        <option value="363">Pacific/Nauru</option>
                        <option value="364">Pacific/Niue</option>
                        <option value="365">Pacific/Norfolk</option>
                        <option value="366">Pacific/Noumea</option>
                        <option value="367">Pacific/Pago_Pago</option>
                        <option value="368">Pacific/Palau</option>
                        <option value="369">Pacific/Pitcairn</option>
                        <option value="370">Pacific/Ponape</option>
                        <option value="371">Pacific/Port_Moresby</option>
                        <option value="372">Pacific/Rarotonga</option>
                        <option value="373">Pacific/Saipan</option>
                        <option value="374">Pacific/Tahiti</option>
                        <option value="375">Pacific/Tarawa</option>
                        <option value="376">Pacific/Tongatapu</option>
                        <option value="377">Pacific/Truk</option>
                        <option value="378">Pacific/Wake</option>
                        <option value="379">Pacific/Wallis</option>
                        <option value="380">Pacific/Yap</option> 
                        </select>
                        <button type="button" onclick="SubmitTimeZone(); return false;">Submit</button>
                        </fieldset>
                        </form>


                        <form>
                        <fieldset>
                        <legend>Manual adjust</legend>
                         
                           <input type="checkbox" id="DLSOverrid" name="DLSOverrid" value="1">
                           <label class="label" for="DLSOverrid">Disable automatic daylight saving</label>
                           <br>
                          <input type="checkbox" id="ManualDLS" name="ManualDLS" value="1"/>
                        <label class="label" for="ManualDLS">Manual daylight saving</label>
                        <select name="dls_offset" id="dls_offset">
                        <option value="0">-01:00</option> 
                        <option value="1">-00:30</option>
                        <option value="2">+00:00</option>
                        <option value="3">+00:30</option> 
                        <option value="4">+01:00</option>
                        </select>
                        <br>
                          <input type="checkbox" id="ZONE_OVERRRIDE" name="ZONE_OVERRRIDE" value="DLS_OFF">Override Timezone<br>
                          <input style="width:60px" type="number" id="GMT_OFFSET" name="gmt_offset" min="-1440" max="1440" value="0"> GMT Offset ( Minutes )
                          <br>
                           <br>                        
                           <button type="button" onclick="SubmitOverrides(); return false;">Submit</button>
                          </fieldset>
                        </form>

                        </div>
                        </td>
                        </tr>
                     </tbody>
                     </table>
            
				
			</div>
            
            <div id="Notes" class="views grid">
         
                     
                     
                      <table>
						<thead>
							<tr>
                                <th colspan="2">Notes</th>
                            	</tr>
						</thead>
                        <tbody>
							<tr>
                            <td>
            
            
                        
                        <fieldset>
                         <legend>Up to 500 characters for your notes</legend>
                            <textarea name="NotesText" id="NotesText" cols = "80" rows="10"></textarea><br>
                            <button type="button" onclick="UpdateNote(); return false;">Update Notes</button>
                        </fieldset>
                        
                        </td>
                        </tr>
                    </table>
            
				
			</div>
			
            
			<div id="WiFiSettings" class="views grid">
				<div>
					<table>
						<thead>
							<tr>
								<th colspan="2">Network settings</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>SSID</td><td><select id="ssid"></select><br><button onclick="getSSIDList()">Refresh</button></td>
							</tr>
							<tr>
								<td>Password</td><td><input type="password" id="pass"></td>
							</tr>
							<tr>
								<td colspan="1"><button onclick="setWiFiSettings(); return false;">Connect</button></td><td><button onclick="clearWiFiSettings(); return false;">Clear WiFi Settings</button></td>
							</tr>
						</tbody>
					</table>
				</div>
				<div>
					<table>
						<thead>
							<tr>
								<th>Current network configuration</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td id="currentSSID"></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div id="notification" class="notification">
			</div>
		</div>
        
	</body>


    
	<script>
        
        
        
		function pageLoad() {
            showMainPage();
              sendRequest("display/settings", read_display_settings);
            /* we need to load the notes */
            sendRequest("notes.dat", read_notes);
		}
        
        function showMQTTPage(){
            sendRequest("mqtt/settings", read_mqttsettings);
            showView("MQTTView");
        }

		//get a list of available SSIDs
		function getSSIDList() {
			openNotification("Getting network names...", 0);
			sendRequest("getSSIDList", getSSIDListHandler);
		}
		function getSSIDListHandler(data, separator = ",") {
			openNotification("Done");
			setTimeout(closeNotification, 1000);
			if (data == null)
				return;
			var ssids = data.split(separator);
			var list = document.getElementById("ssid");
			list.innerHTML = "";
			if (ssids.length == 0) {
				list.innerHTML = "<option value='0'>-</option>";
				return;
			}
			for (var i = 0; i < ssids.length; i++) {
				list.innerHTML += "<option value='" + ssids[i] + "'>" + ssids[i] + "</option>";
			}
		}

		//get and set wifi settings
		function setWiFiSettings() {
			var ssid = document.getElementById("ssid").value;
			var pass = document.getElementById("pass").value;
			console.log("ssid: " + ssid + ", pass: " + pass);
			var request = "setWiFiSettings?ssid=" + ssid + "&pass=" + pass;
			sendRequest(request, openNotification);
		}
		function getWiFiSettings() {
			openNotification("Getting data...", 0);
			sendRequest("getWiFiSettings", getWiFiSettingsHandler);
		}
		function getWiFiSettingsHandler(data) {
			var d = data.split(",");
			document.getElementById("currentSSID").innerHTML = ((d[0] != "") ? d[0] : "No network configured");
			getSSIDListHandler(d[1], ";");
		}
		
		
		function showTimeSettings(){
            sendRequest("timesettings", read_timesettings);
            showView("TimeSettings");
        }
		
        function showIPv4Settings(){
            sendRequest("ipv4settings.json", read_ipv4settings);
            showView("IPv4Settings");
        }
       
        
        function read_timesettings(msg){
        
            var jsonObj = JSON.parse(msg)
            
            document.getElementById("ZONE_OVERRRIDE").checked = jsonObj.zoneoverride;
            document.getElementById("DLSOverrid").checked = jsonObj.dlsdis;
            document.getElementById("ManualDLS").checked = jsonObj.dlsmanena;
            
           
            var element = document.getElementById("GMT_OFFSET");
            element.value = jsonObj.gmtoffset;
            
       
            var element = document.getElementById("timezoneid");
            element.value = jsonObj.tzidx;
            
        
            var element = document.getElementById("dls_offset");
            element.value = jsonObj.dlsmanidx;
            
            
            var element = document.getElementById("date");
            element.value = jsonObj.date;
           
            
            var element = document.getElementById("time");
            element.value=jsonObj.time;
            
            /* We need also to read if we sync on GPS */
            document.getElementById("GPS_SYNC_ON").checked = jsonObj.gps_sync;
            document.getElementById("GPS_ROLLLOVERCNT").value = jsonObj.gps_rollovercnt;
            
        
        }
        
		function showNotes(){
            showView("Notes");
            LoadNotes();
        }
		
        function showMainPage(){
        
            showView("MainPage");
        }
        
        function testAlarm() {
			sendRequest("testAlarm", openNotification);
		}
		
		function sendRequest(addr, func = null) {
			console.log("requesting: " + addr);
			requestPending = true;
			var xhr = new XMLHttpRequest();
			//xhr.timeout = 5000; //ms
			xhr.open("GET", addr, true);
			xhr.onload = function() {
				console.log("Request finished");
				requestPending = false;
				if (func != null)
					func(this.responseText);
			}
			xhr.onerror = function() {
				console.log("Request finished");
				requestPending = false;
				console.log("error");
			}
			xhr.ontimeout = function() {
				console.log("Request finished");
				requestPending = false;
				console.log("timeout");
			}
			xhr.send();
		}

		//open and close the main menu
		function openMenu() {
			document.getElementById("menu").classList.add("open");
		}
		function closeMenu() {
			document.getElementById("menu").classList.remove("open");
		}

		//show and hide the notification bar
		function openNotification(msg, timeout=2500) {
			document.getElementById("notification").innerHTML = msg;
			document.getElementById("notification").classList.add("open");
			if (timeout != 0)
				setTimeout(closeNotification, timeout);
		}
		function closeNotification() {
			document.getElementById("notification").classList.remove("open");
		}


		//enable alarm cb
		function enableAlarm() {
			var cb = document.getElementById("alarmEnabled").checked;
			document.getElementById("alarmLevelRow").style.display = (cb ? "" : "none");
		}

		//show the wifi settings data
		
		function showWiFiSettings() {
			showView("WiFiSettings");
			getWiFiSettings();
		}
		
        function restart() {
			sendRequest("restart", openNotification);
		}
		
		
		function showView(view) {
            Array.from(document.getElementsByClassName("views")).forEach(function(v) {v.style.display = "none";});
			document.getElementById(view).style.display = "";
			Array.from(document.getElementsByClassName("menuBtn")).forEach(function(b) {b.classList.remove("active")});
			document.getElementById(view + "Btn").classList.add("active");

		}
		
		
        function LoadParameter(){
             sendRequest("timesettings", read_timesettings);
             
        }
        
        function SubmitTimeZone(){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/timezone.dat";
            
            var element = document.getElementById("timezoneid");
            var data = [];
            data.push({key:"timezoneid",
                       value:  element.value});
            
            sendData(url,data); 
        }                 
        
        function SubmitDateTime(){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/settime.dat";
            
            var element = document.getElementById("date");
            var d = element.value;
           
            
            var element = document.getElementById("time");

            var t=element.value;
            var parts = t.split(':');
            //This will result in ideal conditions in three parts
            if(parts.length < 3){
                //We assume only hours and minutes here ( iphone style )
                t=parts[0]+":"+parts[1]+":00";
            }
            var data = [];
            data.push({key:"date",
                       value: d});
            data.push({key:"time",
                       value: t});
            
            sendData(url,data); 
        
        
        }
        
        function SubmitGPSsync(){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/gps/syncclock.dat";
            
            var gpssync_ena=document.getElementById("GPS_SYNC_ON").checked;
            var gps_rollover_offset = document.getElementById("GPS_ROLLLOVERCNT").value;
            //var gps_baudrate = document.getElementById("GPS_BAUDRATE").value;
            
            var data = [];
            if(true===gpssync_ena){
            data.push({key:"GPS_SYNC_ON",
                       value: gpssync_ena});
            }

            /*
            data.push({key:"GPS_BAUD",
                       value: gps_baudrate});                       
            */
            data.push({key:"GPS_ROLLOVERCNT",
                       value: gps_rollover_offset});
            sendData(url,data); 
        
        
        }
        
        function SubmitOverrides(){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/overrides.dat";
            
            var zoneoverride = document.getElementById("ZONE_OVERRRIDE").checked;
            var dls_override = document.getElementById("DLSOverrid").checked;
            var dlsmanena = document.getElementById("ManualDLS").checked;
            
           
            var element = document.getElementById("GMT_OFFSET");
            var gmtoffset = element.value;
            
            var element = document.getElementById("dls_offset");
            var dlsoffsetidx=element.value;
            
            
            
            
            var data = [];
            if(true===zoneoverride){
            data.push({key:"ZONE_OVERRRIDE",
                       value: zoneoverride});
            }
            
            if(true===dls_override){
            data.push({key:"dlsdis",
                       value: dls_override});
            }
            
             if(true===dlsmanena){
            data.push({key:"dlsmanena",
                       value: dlsmanena});
            }
                       
            data.push({key:"dlsmanidx",
                       value: dlsoffsetidx});
                       
            data.push({key:"gmtoffset",
                       value: gmtoffset});
            
            sendData(url,data); 
        
        
        }
        
        function SendSleepMode(){
        var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/led/activespan.dat";
            
            var element = document.getElementById("sh_start");
            var start = element.value;
           
            
            var element = document.getElementById("sh_end");
            var end=element.value;
            
            var nightmode = document.getElementById("Enable Nightmode").checked;
            
            
            var data = [];
            data.push({key:"silent_start",
                       value: start});
            data.push({key:"silent_end",
                       value: end});
            data.push({key:"enable",
                       value: nightmode});
            
            sendData(url,data); 
        }
        
        
        
        
        
        function read_displaystatus( msg){
        
             //var jsonObj = JSON.parse(msg);
             
             

            
        
        }
        
        
        function read_ipv4settings( msg){
        
            var jsonObj = JSON.parse(msg);
            
            document.getElementById("STATIC_IP").checked = jsonObj.USE_STATIC;
            document.getElementById("IP_0").value = jsonObj.IP[0];
            document.getElementById("IP_1").value = jsonObj.IP[1];
            document.getElementById("IP_2").value = jsonObj.IP[2];
            document.getElementById("IP_3").value = jsonObj.IP[3];

            document.getElementById("SUB_0").value = jsonObj.SUBNET[0];
            document.getElementById("SUB_1").value = jsonObj.SUBNET[1];
            document.getElementById("SUB_2").value = jsonObj.SUBNET[2];
            document.getElementById("SUB_3").value = jsonObj.SUBNET[3];

            document.getElementById("GW_0").value = jsonObj.GATEWAY[0];
            document.getElementById("GW_1").value = jsonObj.GATEWAY[1];
            document.getElementById("GW_2").value = jsonObj.GATEWAY[2];
            document.getElementById("GW_3").value = jsonObj.GATEWAY[3];
           
            document.getElementById("DNS0_0").value = jsonObj.DNS0[0];
            document.getElementById("DNS0_1").value = jsonObj.DNS0[1];
            document.getElementById("DNS0_2").value = jsonObj.DNS0[2];
            document.getElementById("DNS0_3").value = jsonObj.DNS0[3];            

            document.getElementById("DNS1_0").value = jsonObj.DNS1[0];
            document.getElementById("DNS1_1").value = jsonObj.DNS1[1];
            document.getElementById("DNS1_2").value = jsonObj.DNS1[2];
            document.getElementById("DNS1_3").value = jsonObj.DNS1[3];   
            
        
        }
        
        
          function SubmitIPv4Settings(){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/ipv4settings.json";
            
            var data = [];
            
            var use_static = document.getElementById("STATIC_IP").checked;
            
            var ip = [];
            
            ip.push(document.getElementById("IP_0").value );
            ip.push(document.getElementById("IP_1").value );
            ip.push(document.getElementById("IP_2").value );
            ip.push(document.getElementById("IP_3").value );

            var sub = [];
            
            sub.push( document.getElementById("SUB_0").value );
            sub.push( document.getElementById("SUB_1").value );
            sub.push( document.getElementById("SUB_2").value );
            sub.push(  document.getElementById("SUB_3").value );

            var gw = [];
            gw.push( document.getElementById("GW_0").value );
            gw.push( document.getElementById("GW_1").value );
            gw.push( document.getElementById("GW_2").value );
            gw.push( document.getElementById("GW_3").value );
           
            var dns0 = [];
            
            dns0.push( document.getElementById("DNS0_0").value );
            dns0.push( document.getElementById("DNS0_1").value );
            dns0.push( document.getElementById("DNS0_2").value );
            dns0.push( document.getElementById("DNS0_3").value );         

            var dns1 = [];
            
            dns1.push( document.getElementById("DNS1_0").value );
            dns1.push( document.getElementById("DNS1_1").value );
            dns1.push( document.getElementById("DNS1_2").value );
            dns1.push( document.getElementById("DNS1_3").value ); 
            
            var obj = {};
            obj["USE_STATIC"]=use_static;
            obj["IP"]=(ip);
            obj["SUBNET"]=(sub);
            obj["GATEWAY"]=(gw);
            obj["DNS0"]=(dns0);
            obj["DNS1"]=(dns1);
         
            
            data.push({key:"JSON",
                       value: JSON.stringify(obj)  });
            
            sendData(url,data); 
        
        
        }
        
       function read_mqttsettings( msg ){
            var jsonObj = JSON.parse(msg);
            
            
            document.getElementById("MQTT_USER").value = jsonObj.mqttuser;
            document.getElementById("MQTT_HOST").value = jsonObj.mqtthost;
            document.getElementById("MQTT_SERVER").value = jsonObj.mqttserver;
            document.getElementById("MQTT_PORT").value = jsonObj.mqttport;
            document.getElementById("MQTT_PASS").value = jsonObj.mqttpass;
            document.getElementById("MQTT_TOPIC").value = jsonObj.mqtttopic;
            document.getElementById("MQTT_PASS").type = "password";
            document.getElementById("MQTT_ENA").checked = jsonObj.mqttena;
             
            
        }
        
          
        function clearWiFiSettings(){
            var ssid ="";
			var pass = "";
			console.log("Clear WiFi Settings");
			var request = "setWiFiSettings?ssid=" + ssid + "&pass=" + pass;
			sendRequest(request, openNotification);
        }
        
        
        function UpdateNote(){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/notes.dat";
            
            var element = document.getElementById("NotesText");
            var text= element.value;
            text = text.substring(0, 500);
            
            
            
            
            var data = [];
            data.push({key:"notes",
                       value: text});
            sendData(url,data); 
             
             
        
        }
        
         function read_display_settings(msg){
            var jsonObj = JSON.parse(msg);
            document.getElementById("SWAP_DISP").checked = jsonObj.swap_display;
        }
        
        function SubmitDisplaysettings( ){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/display/settings";
            
            var swapped = document.getElementById("SWAP_DISP").checked;
            
            
            
            var data = [];
            data.push({key:"SWAP_DISP",
                       value: swapped});
            sendData(url,data); 
             
        
        }
        
        
          function SubmitMQTT( ){
            var protocol = location.protocol;
            var slashes = protocol.concat("//");
            var host = slashes.concat(window.location.hostname);
            var url = host + "/mqtt/settings";
            
            
            var mqtt_user = document.getElementById("MQTT_USER").value;
            var mqtt_host = document.getElementById("MQTT_HOST").value;
            var mqtt_server = document.getElementById("MQTT_SERVER").value;
            var mqtt_port = document.getElementById("MQTT_PORT").value;
            var mqtt_topic =  document.getElementById("MQTT_TOPIC").value;
            var mqtt_ena = document.getElementById("MQTT_ENA").checked;
            
            
            var data = [];
            data.push({key:"MQTT_ENA",
                           value: mqtt_ena}); 
            
            data.push({key:"MQTT_PORT",
                           value: mqtt_port});
           
            
            data.push({key:"MQTT_USER",
                       value: mqtt_user});
                       
            data.push({key:"MQTT_HOST",
                       value: mqtt_host});
            
            
            data.push({key:"MQTT_SERVER",
                       value: mqtt_server});
                       
            data.push({key:"MQTT_TOPIC",
                       value: mqtt_topic});
            
            if( "password" != document.getElementById("MQTT_PASS").type){
                var mqtt_pass = document.getElementById("MQTT_PASS").value;
                data.push({key:"MQTT_PASS",
                       value: mqtt_pass});
                
                document.getElementById("MQTT_PASS").value = "********";
                document.getElementById("MQTT_PASS").type = "password";
                
            }            
                       
            sendData(url,data); 
             
             
            
        
        }
 
        
        
        function mqtt_pass_onclick(){
        
                document.getElementById("MQTT_PASS").value = "";
                document.getElementById("MQTT_PASS").type == "text";
       
       }
        
        function LoadNotes(){
            sendRequest("notes.dat", read_notes);
        
        }
        
        function read_notes(msg){
            //Plain text 
            var element = document.getElementById("NotesText");
            element.value = msg;
            
        }
        
       
        
        
     
        
        
        
        
        
        
        function httpGetAsync(theUrl, callback)
        {
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function() { 
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                if(callback != null){
                    callback(xmlHttp.responseText);
                }
            }
            xmlHttp.open("GET", theUrl, true); // true for asynchronous 
            xmlHttp.send(null);
        }
        
        function sendData(url,data) {       
          var XHR = new XMLHttpRequest();
          var urlEncodedData = "";
          var urlEncodedDataPairs = [];
          var name;

          for(name in data) {
            urlEncodedDataPairs.push(encodeURIComponent(data[name].key) + '=' + encodeURIComponent(data[name].value));
          }

          urlEncodedData = urlEncodedDataPairs.join('&').replace(/%20/g, '+');

          XHR.addEventListener('load', function(event) {
            /*   */
          });

          XHR.addEventListener('error', function(event) {
            alert('Oops! Something goes wrong.');
          });

          XHR.open('POST', url);
          XHR.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
          XHR.send(urlEncodedData);
          
        }
                
        function leftPad(num, size) {
            var s = num+"";
            while (s.length < size) s = "0" + s;
            return s;
        }

		
		
	</script>
     
</html>